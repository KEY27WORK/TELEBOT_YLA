"""
currency_manager.py ‚Äî –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∞–ª—é—Ç –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –∫–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ Monobank API.

üîπ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—Å—ñ—Ö –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤ –≤–∞–ª—é—Ç (USD, EUR, GBP, PLN) –∑ API Monobank
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫—É—Ä—Å—ñ–≤ —É –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—ñ (JSON-—Å–ª–æ–≤–Ω–∏–∫)
- –ö–µ—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ API –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—É—Ä—Å—É, —è–∫—â–æ –Ω–æ–≤–∏–π –∫—É—Ä—Å –≤–∏—â–∏–π –∑–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π
- –ü–µ—Ä–µ—Ö—Ä–µ—Å–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –º—ñ–∂ –±—É–¥—å-—è–∫–∏–º–∏ –≤–∞–ª—é—Ç–∞–º–∏
- –†—É—á–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—É—Ä—Å—É –¥–ª—è –æ–∫—Ä–µ–º–æ—ó –≤–∞–ª—é—Ç–∏

üì¶ –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É –∑ –∫—É—Ä—Å–∞–º–∏ (current_rate.txt):
{
    "USD": 42.30,
    "EUR": 45.10,
    "GBP": 49.85,
    "PLN": 10.75
}

üîó –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
- requests ‚Äî –¥–ª—è –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ API Monobank
- json ‚Äî –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–µ—à—É
- logging ‚Äî –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É
- os ‚Äî –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–∞–π–ª–æ–≤–æ—é —Å–∏—Å—Ç–µ–º–æ—é
"""


import requests
import logging
import os
import json


class CurrencyManager:
    """
    üí± –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∞–ª—é—Ç –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é API Monobank, –∫–µ—à—É–≤–∞–Ω–Ω—è–º —Ç–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—î—é.

    üîπ –§—É–Ω–∫—Ü—ñ—ó:
    - –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫—É—Ä—Å—ñ–≤ –∑ Monobank (USD, EUR, GBP, PLN)
    - –ö–µ—à—É–≤–∞–Ω–Ω—è –∫—É—Ä—Å—ñ–≤ —É –æ–¥–Ω–æ–º—É JSON-—Ñ–∞–π–ª—ñ
    - –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—É—Ä—Å—ñ–≤ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—ñ
    - –†—É—á–Ω–µ –∑–∞–¥–∞–Ω–Ω—è –∫—É—Ä—Å—É
    - –ü–µ—Ä–µ—Ö—Ä–µ—Å–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –º—ñ–∂ –≤–∞–ª—é—Ç–∞–º–∏
    """

    MONOBANK_API_URL = "https://api.monobank.ua/bank/currency"
    UAH_CODE = 980
    RATE_FILE = os.path.join(os.path.dirname(__file__), "current_rate.txt")

    # –ö–æ–¥–∏ –≤–∞–ª—é—Ç –ø–æ ISO 4217
    CURRENCY_CODES = {
        "USD": 840,
        "EUR": 978,
        "GBP": 826,
        "PLN": 985,
    }

    def __init__(self, margin: float = 0.5):
        """
        ‚öôÔ∏è –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≤–∞–ª—é—Ç.

        :param margin: –ú–∞—Ä–∂–∞ —É –≥—Ä–∏–≤–Ω—è—Ö, —è–∫–∞ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ –∫—É—Ä—Å—É
        """
        self.margin = margin
        self._api_data = None  # üîÑ –ö–µ—à API-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
        self.rates = self._load_rates_from_file()

    def _load_rates_from_file(self) -> dict:
        """
        üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫—É—Ä—Å—ñ–≤ –∑ –∫–µ—à-—Ñ–∞–π–ª—É.
        """
        if os.path.exists(self.RATE_FILE):
            try:
                with open(self.RATE_FILE, "r") as file:
                    data = json.load(file)
                    logging.info(f"üìñ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∫–µ—à–æ–≤–∞–Ω—ñ –∫—É—Ä—Å–∏: {data}")
                    return data
            except Exception as e:
                logging.warning(f"‚ö†Ô∏è –ù–µ–º–æ–∂–ª–∏–≤–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª –∑ –∫—É—Ä—Å–∞–º–∏: {e}")
        # üì¶ –Ø–∫—â–æ —Ñ–∞–π–ª –≤—ñ–¥—Å—É—Ç–Ω—ñ–π ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –¥–µ—Ñ–æ–ª—Ç
        return {currency: 42.3 for currency in self.CURRENCY_CODES}

    def _save_rates_to_file(self):
        """
        üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤ —É —Ñ–∞–π–ª.
        """
        try:
            with open(self.RATE_FILE, "w") as file:
                json.dump(self.rates, file, indent=2)
                logging.info(f"üíæ –ö–µ—à –∫—É—Ä—Å—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–æ: {self.rates}")
        except Exception as e:
            logging.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –∫—É—Ä—Å—ñ–≤: {e}")

    def _fetch_monobank_data(self):
        """
        üåê –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ API Monobank (–æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ —Ü–∏–∫–ª).
        
        - –ö–µ—à—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∑–∞–π–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —É —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É.
        - –†–æ–±–∏—Ç—å –º–∞–∫—Å–∏–º—É–º 2 —Å–ø—Ä–æ–±–∏ –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ.
        - –Ø–∫—â–æ –¥–∞–Ω—ñ –Ω–µ –æ—Ç—Ä–∏–º–∞–Ω—ñ ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫.
        """
        # üß† –Ø–∫—â–æ –≤–∂–µ —î –∫–µ—à–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —ó—Ö, –Ω–µ —Ä–æ–±–∏–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç
        if self._api_data is not None:
            return self._api_data
    
        # üîÅ –ü—Ä–æ–±—É—î–º–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ Monobank –º–∞–∫—Å–∏–º—É–º 2 —Ä–∞–∑–∏
        for attempt in range(2):
            try:
                # üì° –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ GET-–∑–∞–ø–∏—Ç –¥–æ Monobank API
                response = requests.get(self.MONOBANK_API_URL, timeout=5)
                response.raise_for_status()  # –í–∏–∫–∏–¥–∞—î –≤–∏–Ω—è—Ç–æ–∫, —è–∫—â–æ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥ –Ω–µ 200
    
                # üì¶ –†–æ–∑–ø–∞—Ä—Å–∏–º–æ JSON-–≤—ñ–¥–ø–æ–≤—ñ–¥—å —ñ –∑–±–µ—Ä–µ–∂–µ–º–æ —ó—ó –≤ –∫–µ—à
                self._api_data = response.json()
    
                # ‚úÖ –Ø–∫—â–æ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ ‚Äî –ª–æ–≥ —ñ –≤–∏—Ö—ñ–¥ –∑ —Ü–∏–∫–ª—É
                if self._api_data:
                    logging.info("‚úÖ –î–∞–Ω—ñ –∑ Monobank —É—Å–ø—ñ—à–Ω–æ –æ—Ç—Ä–∏–º–∞–Ω—ñ")
                    break
                
            except Exception as e:
                # ‚ùå –õ–æ–≥ –ø–æ–º–∏–ª–∫–∏ –∑ –∑–∞–∑–Ω–∞—á–µ–Ω–Ω—è–º –Ω–æ–º–µ—Ä–∞ —Å–ø—Ä–æ–±–∏
                logging.error(f"‚ùå –°–ø—Ä–æ–±–∞ {attempt+1}: –ü–æ–º–∏–ª–∫–∞ Monobank ‚Äî {e}")
                time.sleep(2)  # üí§ –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Å–ø—Ä–æ–±–æ—é
    
        # ‚õî –Ø–∫—â–æ –ø—ñ—Å–ª—è 2 —Å–ø—Ä–æ–± –¥–∞–Ω—ñ –Ω–µ –æ—Ç—Ä–∏–º–∞–Ω—ñ ‚Äî –ª–æ–≥ —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –∫–µ—à—É
        if not self._api_data:
            logging.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –∑ Monobank –Ω–∞–≤—ñ—Ç—å –ø—ñ—Å–ª—è –ø–æ–≤—Ç–æ—Ä—É.")
            self._api_data = []
    
        # üîÅ –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–µ—à–æ–≤–∞–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–º–æ–∂–µ –±—É—Ç–∏ [] –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ)
        return self._api_data
    

    def update_rate(self):
        """
        üîÑ –û–Ω–æ–≤–ª—é—î –∫—É—Ä—Å–∏ –¥–ª—è –≤—Å—ñ—Ö –≤–∞–ª—é—Ç, —è–∫—â–æ –∑ API –Ω–∞–¥—ñ–π—à–ª–∏ –Ω–æ–≤—ñ.
        –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ª–∏—à–µ –ø—Ä–∏ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—ñ –∫—É—Ä—Å—É.
        """
        # üîÑ –û—Ç—Ä–∏–º—É—î–º–æ —Å–ø–∏—Å–æ–∫ –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤ –∑ –∫–µ—à—É –∞–±–æ –∑ Monobank API
        data = self._fetch_monobank_data()
        updated = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å, —á–∏ –±—É–ª–∏ –æ–Ω–æ–≤–ª–µ–Ω—ñ —è–∫—ñ—Å—å –∫—É—Ä—Å–∏

        # üîÅ –ü—Ä–æ—Ö–æ–¥–∏–º–æ—Å—è –ø–æ –∫–æ–∂–Ω—ñ–π –≤–∞–ª—é—Ç—ñ, —è–∫—É –ø—ñ–¥—Ç—Ä–∏–º—É—î–º–æ
        for currency, code in self.CURRENCY_CODES.items():
            try:
                # üîç –®—É–∫–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –∑–∞–ø–∏—Å —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ Monobank API
                for entry in data:
                    if entry["currencyCodeA"] == code and entry["currencyCodeB"] == self.UAH_CODE:
                    
                        # üìê –í–∏—Ç—è–≥—É—î–º–æ –∫—É—Ä—Å: –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–æ –±–µ—Ä–µ–º–æ rateSell, —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î ‚Äî –±–µ—Ä–µ–º–æ rateCross –∞–±–æ rateBuy
                        raw_rate = (
                            entry.get("rateSell") or
                            entry.get("rateCross") or
                            entry.get("rateBuy")
                        )

                        # ‚ùó –Ø–∫—â–æ –∂–æ–¥–Ω–µ –∑ –ø–æ–ª—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Äî –≤–∏–∫–∏–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É
                        if not raw_rate:
                            raise ValueError("–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–ª—è –∫—É—Ä—Å—É (rateSell / rateCross / rateBuy)")

                        # ‚ûï –î–æ–¥–∞—î–º–æ –º–∞—Ä–∂—É —Ç–∞ –æ–∫—Ä—É–≥–ª—é—î–º–æ –¥–æ 2 –∑–Ω–∞–∫—ñ–≤ –ø—ñ—Å–ª—è –∫–æ–º–∏
                        new_rate = round(float(raw_rate) + self.margin, 2)
                        old_rate = self.rates.get(currency, 0)

                        # üî∫ –û–Ω–æ–≤–ª—é—î–º–æ –∫—É—Ä—Å, —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –Ω–æ–≤–∏–π –∫—É—Ä—Å –≤–∏—â–∏–π –∑–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π
                        if new_rate > old_rate:
                            logging.info(f"üî∫ –ö—É—Ä—Å {currency} –æ–Ω–æ–≤–ª–µ–Ω–æ: {old_rate} ‚Üí {new_rate}")
                            self.rates[currency] = new_rate
                            updated = True
                        else:
                            # ‚ÑπÔ∏è –Ø–∫—â–æ –∫—É—Ä—Å –Ω–µ –∑–º—ñ–Ω–∏–≤—Å—è –∞–±–æ —Å—Ç–∞–≤ –Ω–∏–∂—á–∏–º ‚Äî –∑–∞–ª–∏—à–∞—î–º–æ —Å—Ç–∞—Ä–∏–π
                            logging.debug(f"üìâ –ö—É—Ä—Å {currency} –∑–∞–ª–∏—à–∏–≤—Å—è –±–µ–∑ –∑–º—ñ–Ω: {old_rate} ‚â• {new_rate}")
                        break  # ‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –∑–∞–ø–∏—Å, –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –≤–∞–ª—é—Ç–∏
                    
            # ‚ö†Ô∏è –û–±—Ä–æ–±–ª—è—î–º–æ –±—É–¥—å-—è–∫—ñ –≤–∏–Ω—è—Ç–∫–∏ –ø–æ –∫–æ–∂–Ω—ñ–π –≤–∞–ª—é—Ç—ñ –æ–∫—Ä–µ–º–æ, —â–æ–± –Ω–µ –∑—É–ø–∏–Ω—è—Ç–∏ —Ü–∏–∫–ª
            except Exception as e:
                logging.warning(f"‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—É—Ä—Å—É {currency}: {e}")

        # üíæ –Ø–∫—â–æ —Ö–æ—á –æ–¥–Ω–∞ –≤–∞–ª—é—Ç–∞ –±—É–ª–∞ –æ–Ω–æ–≤–ª–µ–Ω–∞ ‚Äî –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–æ–≤—ñ –∫—É—Ä—Å–∏ —É —Ñ–∞–π–ª
        if updated:
            self._save_rates_to_file()


    def get_current_rate(self, currency: str = "USD") -> float:
        """
        üîé –ü–æ–≤–µ—Ä—Ç–∞—î –∞–∫—Ç—É–∞–ª—å–Ω–∏–π –∫—É—Ä—Å UAH –¥–ª—è –∑–∞–¥–∞–Ω–æ—ó –≤–∞–ª—é—Ç–∏.

        :param currency: –ù–∞–∑–≤–∞ –≤–∞–ª—é—Ç–∏ (USD / EUR / GBP / PLN)
        :return: –ö—É—Ä—Å —É –≥—Ä–∏–≤–Ω—è—Ö
        """
        return self.rates.get(currency.upper(), 42.3)

    def set_rate_manually(self, currency: str, rate: float):
        """
        ‚úçÔ∏è –†—É—á–Ω–µ –∑–∞–¥–∞–Ω–Ω—è –∫—É—Ä—Å—É –∑ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º —Ñ–∞–π–ª—É.

        :param currency: –ù–∞–∑–≤–∞ –≤–∞–ª—é—Ç–∏
        :param rate: –ó–Ω–∞—á–µ–Ω–Ω—è –≤ –≥—Ä–∏–≤–Ω—è—Ö
        """
        self.rates[currency.upper()] = rate
        self._save_rates_to_file()

    def get_all_rates(self) -> dict:
        """
        üì¶ –ü–æ–≤–µ—Ä—Ç–∞—î —É—Å—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∫—É—Ä—Å–∏ –≤–∞–ª—é—Ç –∑ –∫–µ—à—É.

        :return: –°–ª–æ–≤–Ω–∏–∫ { "USD": 42.3, "EUR": 44.1, ... }
        """
        return self.rates

    def convert(self, amount: float, from_currency: str, to_currency: str, rates: dict) -> float:
        """
        üîÑ –ö–æ–Ω–≤–µ—Ä—Ç—É—î —Å—É–º—É –∑ –æ–¥–Ω—ñ—î—ó –≤–∞–ª—é—Ç–∏ –≤ —ñ–Ω—à—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–µ—Ä–µ–¥–∞–Ω–∏—Ö –∞–±–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –∫—É—Ä—Å—ñ–≤.
        
        :param amount: –°—É–º–∞ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó
        :param from_currency: –í–∏—Ö—ñ–¥–Ω–∞ –≤–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "USD")
        :param to_currency: –¶—ñ–ª—å–æ–≤–∞ –≤–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "UAH")
        :param rates: –ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π —Å–ª–æ–≤–Ω–∏–∫ –∫—É—Ä—Å—ñ–≤ ({"USD": 41.0, "EUR": 44.5, ...})
        
        :return: –°—É–º–∞ —É —Ü—ñ–ª—å–æ–≤—ñ–π –≤–∞–ª—é—Ç—ñ
        """
        
        if from_currency == to_currency:
            return round(amount, 2)

        try:
            if rates:
                from_rate = rates[from_currency.upper()]
                to_rate = rates[to_currency.upper()]
            else:
                from_rate = self.get_current_rate(from_currency)
                to_rate = self.get_current_rate(to_currency)

            result = round(amount * from_rate / to_rate, 2)
            logging.info(f"üîÅ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è: {amount} {from_currency} ‚Üí {result} {to_currency}")
            return result
        except Exception as e:
            logging.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó {from_currency} ‚Üí {to_currency}: {e}")
            return 0.0

