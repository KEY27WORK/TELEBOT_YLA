# üß© Domain Layer

–ß–∏—Å—Ç—ã–π –¥–æ–º–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: **–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã**, **DTO/—Å—É—â–Ω–æ—Å—Ç–∏** –∏ **–±–∏–∑–Ω–µ—Å‚Äë—Å–µ—Ä–≤–∏—Å—ã –±–µ–∑ I/O**.  
–ù–∏–∫–∞–∫–∏—Ö HTTP, —Ñ–∞–π–ª–æ–≤, SDK –∏ –ª–æ–≥–≥–µ—Ä–æ–≤ ‚Äî —Ç–æ–ª—å–∫–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞.

---

## üß± –ü—Ä–∏–Ω—Ü–∏–ø—ã

- **–ß–∏—Å—Ç–æ—Ç–∞:** —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–¥–µ—Å—å –Ω–µ—Ç.
- **–¢–æ—á–Ω–æ—Å—Ç—å:** —Ñ–∏–Ω–∞–Ω—Å—ã ‚Äî —á–µ—Ä–µ–∑ `Decimal`; –Ω–∏–∫–∞–∫–∏—Ö `float`.
- **–ï–¥–∏–Ω–∏—Ü—ã:** –≤–µ—Å ‚Äî –≤—Å–µ–≥–¥–∞ **–≤ –≥—Ä–∞–º–º–∞—Ö (int)**.
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤—Ö–æ–¥ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤—ã—Ö–æ–¥.
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** `Enum`, `Literal`, `Protocol`/`ABC`, `@dataclass(frozen=True, slots=True)`.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```bash
domain/
‚îú‚îÄ ai/                # –ü—Ä–æ–º–ø—Ç—ã/LLM (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, DTO)
‚îú‚îÄ availability/      # –ù–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö
‚îú‚îÄ content/           # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ö–µ—à—Ç–µ–≥—ñ–≤
‚îú‚îÄ currency/          # –ì—Ä–æ—à—ñ/–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∏
‚îú‚îÄ delivery/          # –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏
‚îú‚îÄ image_generation/  # –ö–æ–Ω—Ç—Ä–∞–∫—Ç —Ä–æ–±–æ—Ç–∏ –∑—ñ —à—Ä–∏—Ñ—Ç–∞–º–∏
‚îú‚îÄ music/             # –ú—É–∑–∏—á–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó/–∫–µ—à
‚îú‚îÄ pricing/           # –ü—Ä–∞–π—Å–∏–Ω–≥ (DTO + —á–∏—Å—Ç–∏–π —Å–µ—Ä–≤—ñ—Å)
‚îú‚îÄ products/          # –°—É—Ç–Ω–æ—Å—Ç—ñ/–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ + —Å–µ—Ä–≤—ñ—Å–∏
‚îú‚îÄ size_chart/        # –¢–∞–±–ª–∏—Ü—ñ —Ä–æ–∑–º—ñ—Ä—ñ–≤ (–ø—Ä–æ–≥—Ä–µ—Å + –ø—Ä–æ—Ç–æ–∫–æ–ª–∏)
‚îî‚îÄ web/               # –ö–æ–Ω—Ç—Ä–∞–∫—Ç –≤–µ–±-–∫–ª—ñ—î–Ω—Ç–∞
```

---

## üîå –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏

- **AI:** `app/domain/ai/interfaces/prompt_service_interface.py`  
  –ö–æ–Ω—Ç—Ä–∞–∫—Ç `IPromptService`, DTO `ChatPrompt`, `ProductPromptDTO`, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏ `TextPart`/`ImagePart`.

- **Availability:** `app/domain/availability`  
  DTO `RegionStock`, `AvailabilityReport`, enum `AvailabilityStatus`, —Å–µ—Ä–≤–∏—Å `AvailabilityService`  
  –∏ –∫–ª—é—á —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ `default_size_sort_key`.

- **Currency:** `app/domain/currency/interfaces.py`  
  DTO `Money`, –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã `IMoneyConverter` (–æ—Å–Ω–æ–≤–Ω–æ–π) –∏ `ICurrencyConverter` (legacy).

- **Delivery:** `app/domain/delivery/interfaces.py`  
  DTO `DeliveryQuote`, –∫–æ–Ω—Ç—Ä–∞–∫—Ç `IDeliveryService` (–≤–µ—Å ‚Äî **–≥—Ä–∞–º–º—ã**).

- **Music:** `app/domain/music/interfaces.py`  
  DTO `RecommendedTrack`, `MusicRecommendationResult`, `TrackInfo`; –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã `IMusicRecommender` –∏ –¥—Ä.  
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ProductPromptDTO` –∏–∑ –¥–æ–º–µ–Ω–∞ `ai`.

- **Pricing:** `app/domain/pricing`  
  –ö–æ–Ω—Ç—Ä–∞–∫—Ç `IPriceService` (`build_quote`), DTO `PriceInput` ‚Üí `PriceBreakdown`, —É—Ç–∏–ª–∏—Ç—ã `q2`, `percent`,  
  –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `PriceService` + `PricingRules`.

- **Products:** `app/domain/products`  
  –°—É—â–Ω–æ—Å—Ç—å `ProductInfo` (–≤–∞–ª–∏–¥–∏—Ä—É–µ–º–∞—è, immutable), –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã `IProductDataProvider` –∏ —Ç.–¥.,  
  —Å–µ—Ä–≤–∏—Å `WeightResolver` (–ª–æ–∫–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ ‚Üí AI‚Äëfallback).

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å

- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚Äî —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã ‚áí –ª–µ–≥–∫–æ –º–æ–∫–∞—é—Ç—Å—è.
- –î–µ–Ω—å–≥–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ `quantize`/`q2`.
- –î–ª—è availability –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `default_size_sort_key`).

---

## üß≠ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥–ø–∞–∫–µ—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```python
from app.domain.pricing import PriceService, PricingRules, Money, PriceInput
from app.domain.currency.interfaces import IMoneyConverter
```

–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã, –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫—É—Ä—Å–æ–≤, –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ —Ç—Ä–µ–∫–æ–≤, –ø–∞—Ä—Å–µ—Ä—ã –∏ —Ç.–¥.) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–Ω–µ –¥–æ–º–µ–Ω–∞ –∏ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ DI.

---
