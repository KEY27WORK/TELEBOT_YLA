# üß∞ –ü–∞–∫–µ—Ç `utils`

–¶—è –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –º—ñ—Å—Ç–∏—Ç—å –∫–ª—é—á–æ–≤—ñ —É—Ç–∏–ª—ñ—Ç–∏ —Ç–∞ —Å–µ—Ä–≤—ñ—Å–∏, —â–æ —î **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º** –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π —É –ø—Ä–æ—î–∫—Ç—ñ.  
–í–æ–Ω–∏ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω—ñ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –¥–æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ **—á–∏—Å—Ç–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏** (SRP, KISS, DI).

---

## üì¶ –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### `logger.py`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è.
- **–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
  - –ü–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è (—á–µ—Ä–µ–∑ `Lock`)
  - –ö–æ–Ω—Å–æ–ª—å–Ω–∏–π + —Ñ–∞–π–ª–æ–≤–∏–π —Ö–µ–Ω–¥–ª–µ—Ä–∏ –∑ —Ä–æ—Ç–∞—Ü—ñ—î—é
  - –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è ¬´–≥–∞–ª–∞—Å–ª–∏–≤–∏—Ö¬ª —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
- **–ö–ª—é—á–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è**:  
  `setup_logging(config)` ‚Äî —Å—Ç–≤–æ—Ä—é—î —î–¥–∏–Ω–∏–π –ª–æ–≥–µ—Ä –¥–ª—è –≤—Å—å–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É.

---

### `interfaces.py`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π —É—Ç–∏–ª—ñ—Ç.
- **–û—Å–Ω–æ–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å**:
  - `IUrlParsingStrategy` ‚Äî —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è –ø–∞—Ä—Å–∏–Ω–≥—É/–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó URL –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±—Ä–µ–Ω–¥—É.

---

### `url_parser_service.py`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–∞–≥–∞–ª—å–Ω–∏–π —Ñ–∞—Å–∞–¥ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ URL.
- **–ü–æ–±—É–¥–æ–≤–∞–Ω–æ –∑–∞ –ø–∞—Ç–µ—Ä–Ω–æ–º "–°—Ç—Ä–∞—Ç–µ–≥—ñ—è"**:
  - –¥–µ–ª–µ–≥—É—î —Ä–æ–±–æ—Ç—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è–º (`IUrlParsingStrategy`) —É `infrastructure`
  - –Ω–µ –∑–Ω–∞—î –ø—Ä–æ YoungLA —á–∏ —ñ–Ω—à—ñ –±—Ä–µ–Ω–¥–∏
- **–ö–ª—é—á–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**:
  - `is_product_url(url)` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —Ü–µ URL —Ç–æ–≤–∞—Ä—É
  - `is_collection_url(url)` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —Ü–µ URL –∫–æ–ª–µ–∫—Ü—ñ—ó
  - `extract_product_slug(url)` ‚Äî –≤–∏—Ç—è–≥ slug —Ç–æ–≤–∞—Ä—É
  - `get_currency(url)` / `get_region_label(url)` ‚Äî –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∞–ª—é—Ç–∏ —Ç–∞ —Ä–µ–≥—ñ–æ–Ω—É
  - `build_product_url(region_code, product_path)` ‚Äî –ø–æ–±—É–¥–æ–≤–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–æ–≤–∞—Ä

---

### `prompt_service.py`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –Ñ–¥–∏–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –ø—Ä–æ–º—Ç—ñ–≤.
- **–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
  - –õ–µ–¥–∞—á–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (–±–µ–∑ –ø–∞–¥—ñ–Ω–Ω—è –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ)
  - –ö–µ—à—É–≤–∞–Ω–Ω—è (`@lru_cache`)
  - –ß—ñ—Ç–∫—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ñ–≤
- **–ö–ª—é—á–æ–≤—ñ –º–µ—Ç–æ–¥–∏**:
  - `get_prompt(PromptType, **kwargs)` ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π –ø—Ä–æ–º—Ç
  - `get_size_chart_prompt(ChartType)` ‚Äî –∑–±–∏—Ä–∞—î OCR-–ø—Ä–æ–º—Ç (—à–∞–±–ª–æ–Ω + –ø—Ä–∏–∫–ª–∞–¥)

---

### `prompt_loader.py` (deprecated)
- ‚ùó –ó–∞–ª–∏—à–µ–Ω–æ –¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ.
- –î–µ–ª–µ–≥—É—î –≤–∏–∫–ª–∏–∫–∏ —É `PromptService`.
- –°—Ç–∞—Ä–∏–π API:  
  - `load_prompt(file_name, lang="uk")`  
  - `load_ocr_asset(file_name)`

---

### `prompts.py` (deprecated)
- ‚ùó –°—É–º—ñ—Å–Ω–∏–π —à–∞—Ä –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ API (`PromptType`, `ChartType`, —Ñ—É–Ω–∫—Ü—ñ—ó).
- –î–µ–ª–µ–≥—É—î –≤–∏–∫–ª–∏–∫–∏ —É `PromptService`.
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞–ø—Ä—è–º—É:
  ```python
  from app.shared.utils.prompt_service import PromptService, PromptType, ChartType
  ```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó

```bash
üîß utils/
‚îú‚îÄ‚îÄ üìò README.md            # (—Ü–µ–π —Ñ–∞–π–ª) –ø—É—Ç—ñ–≤–Ω–∏–∫ –ø–æ —É—Ç–∏–ª—ñ—Ç–∞—Ö
‚îú‚îÄ‚îÄ üìÑ __init__.py          # –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –µ–∫—Å–ø–æ—Ä—Ç—É –ø–∞–∫–µ—Ç—É
‚îú‚îÄ‚îÄ üìÑ collections.py       # uniq_keep_order —Ç–∞ —ñ–Ω—à—ñ –∫–æ–ª–µ–∫—Ü—ñ–π–Ω—ñ —É—Ç–∏–ª—ñ—Ç–∏
‚îú‚îÄ‚îÄ üìÑ immutables.py        # freeze()/is_frozen_mapping
‚îú‚îÄ‚îÄ üìÑ interfaces.py        # –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ (IUrlParsingStrategy —Ç–æ—â–æ)
‚îú‚îÄ‚îÄ üìÑ locale.py            # –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤
‚îú‚îÄ‚îÄ üìÑ logger.py            # —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ üìÑ number.py            # –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∏—Å–ª–æ–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ —É Decimal
‚îú‚îÄ‚îÄ üìÑ prompt_loader.py     # üîÅ legacy API –¥–ª—è –ø—Ä–æ–º—Ç—ñ–≤
‚îú‚îÄ‚îÄ üìÑ prompt_service.py    # —Å—É—á–∞—Å–Ω–∏–π —Å–µ—Ä–≤—ñ—Å —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ–º—Ç–∞–º–∏
‚îú‚îÄ‚îÄ üìÑ prompts.py           # üîÅ legacy shim
‚îú‚îÄ‚îÄ üìÑ result.py            # —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Ok / Err –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
‚îú‚îÄ‚îÄ üìÑ size_norm.py         # –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–æ–∑–º—ñ—Ä—ñ–≤ –æ–¥—è–≥—É
‚îî‚îÄ‚îÄ üìÑ url_parser_service.py # —Ñ–∞—Å–∞–¥ –ø–∞—Ä—Å–∏–Ω–≥—É URL
```

üß© –í–∏—Å–Ω–æ–≤–æ–∫

–ú–æ–¥—É–ª—å utils ‚Äî —Ü–µ –æ—Å–Ω–æ–≤–∞ —Å–ø—ñ–ª—å–Ω–æ—ó —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏:
	‚Ä¢	—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è,
	‚Ä¢	—Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–∏–π –ø–∞—Ä—Å–∏–Ω–≥ URL,
	‚Ä¢	—É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –ø—Ä–æ–º—Ç—ñ–≤.

–¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —ñ –ø–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–¥—É —É –≤—Å—ñ—Ö —à–∞—Ä–∞—Ö –ø—Ä–æ—î–∫—Ç—É.
