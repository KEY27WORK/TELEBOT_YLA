# ‚öôÔ∏è –ü–∞–∫–µ—Ç `config`

–¶–µ–π –ø–∞–∫–µ—Ç —î **—Ü–µ–Ω—Ç—Ä–æ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è** —É—Å—å–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É. –í—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –ø–æ–≤–Ω–∏–π —Ü–∏–∫–ª —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó: –≤—ñ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ —á–µ—Ä–µ–∑ **DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**.

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
config/
‚îú‚îÄ‚îÄ üìò README.md
‚îú‚îÄ‚îÄ üìú __init__.py
‚îú‚îÄ‚îÄ üìú config_service.py
‚îú‚îÄ‚îÄ üìÇ setup/
‚îÇ   ‚îú‚îÄ‚îÄ üìú container.py
‚îÇ   ‚îú‚îÄ‚îÄ üìú bot_registrar.py
‚îÇ   ‚îî‚îÄ‚îÄ üìú constants.py
‚îî‚îÄ‚îÄ üìÇ yamls/
    ‚îú‚îÄ‚îÄ üìÇ base/
    ‚îú‚îÄ‚îÄ üìÇ features/
    ‚îú‚îÄ‚îÄ üìÇ providers/
    ‚îî‚îÄ‚îÄ üìÇ local/
```

### –ß–æ–º—É –ø—Ä–µ—Ñ—ñ–∫—Å–∏ `00_‚Ä¶ 99_‚Ä¶`?

`ConfigService` –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î **–≤—Å—ñ** `*.yaml` —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∑ `config/yamls/**` —ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î **–≥–ª–∏–±–æ–∫–µ –∑–ª–∏—Ç—Ç—è —É –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É —à–ª—è—Ö—É**. –ó–∞–≤–¥—è–∫–∏ —Ü—å–æ–º—É:
- `base/00_*.yaml` –∑–∞–∫–ª–∞–¥–∞—î –æ—Å–Ω–æ–≤—É.
- –î–∞–ª—ñ –π–¥—É—Ç—å —ñ–Ω—à—ñ —Ñ–∞–π–ª–∏, –¥–æ–ø–æ–≤–Ω—é—é—á–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é.
- `local/99_local.yaml` –∑–∞–≤–∂–¥–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è **–æ—Å—Ç–∞–Ω–Ω—ñ–º** —ñ –º–æ–∂–µ –±–µ–∑–ø–µ—á–Ω–æ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π –∫–ª—é—á –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏.

---

## üîê –†–æ–±–æ—Ç–∞ –∑ `.env`

–°–µ–∫—Ä–µ—Ç–∏ —á–∏—Ç–∞—é—Ç—å—Å—è –∑–∞ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º —ñ–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç: `CONST.LOGIC.ENV_PREFIX` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `APP_`). –ö–æ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –∑ —Ç–∞–∫–∏–º –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —É –≤–∫–ª–∞–¥–µ–Ω–∏–π –∫–ª—é—á:
- `APP_TELEGRAM_BOT_TOKEN=xxx` ‚Üí `telegram.bot.token`
- `APP_OPENAI_API_KEY=xxx` ‚Üí `openai.api.key`

---

## üß© –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### **ConfigService** (Singleton)
- –ß–∏—Ç–∞—î `.env` + –≤—Å—ñ `*.yaml` —ñ–∑ `config/yamls/**`.
- –ù–∞–¥–∞—î —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ `get('a.b.c', default=..., cast=int)` —Ç–∞ `reload()`.

### **Container** (DI)
- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, –ø–µ—Ä–µ–¥–∞—é—á–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏.

### **BotRegistrar**
- –†–µ—î—Å—Ç—Ä—É—î –∫–æ–º–∞–Ω–¥–∏/—Ö–µ–Ω–¥–ª–µ—Ä–∏ –≤ `telegram.ext.Application`, –æ–±–≥–æ—Ä—Ç–∞—é—á–∏ —ó—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º –ø–æ–º–∏–ª–æ–∫ –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

## üöÄ –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

#### –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:
```python
from app.config import ConfigService

config = ConfigService()
# –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω, —è–∫–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ .env –∑–º—ñ–Ω–Ω–æ—ó APP_TELEGRAM_BOT_TOKEN
token = config.get("telegram.bot.token")
# –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–∞–π–º–∞—É—Ç –∑ default-–∑–Ω–∞—á–µ–Ω–Ω—è–º —Ç–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è–º –¥–æ int
timeout = config.get("telegram.http.read_timeout_sec", default=30, cast=int)
```

#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—É `main.py`):
```
python from app.config import ConfigService, Container
config_service = ConfigService()
app_container = Container(config_service)
```

---

## üíæ –§–∞–π–ª–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- **config.yaml** ‚Äî –û—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è: —Ä–µ–≥—ñ–æ–Ω–∏, API, –ª–æ–≥—É–≤–∞–Ω–Ω—è, —Ç–∞–π–º–∞—É—Ç–∏.
- **delivery.yaml** ‚Äî –¢–∞—Ä–∏—Ñ–∏ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É.
- **weights.json** ‚Äî –õ–æ–∫–∞–ª—å–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –≤–∞–≥ —Ç–æ–≤–∞—Ä—ñ–≤ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–æ—Å—Ç–∞–≤–∫–∏.


### parser.images
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
- allowed_ext: –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é [.jpg,.jpeg,.png,.webp,.avif])
- bad_tokens: —Ç–æ–∫–µ–Ω—ã –¥–ª—è –æ—Ç–±—Ä–∞—Å—ã–≤–∞–Ω–∏—è (favicon, sprite, ‚Ä¶)
- min_side_px: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (px), –º–µ–Ω—å—à–µ —Å—á–∏—Ç–∞–µ–º –º–∏–Ω–∏–∞—Ç—é—Ä–æ–π
