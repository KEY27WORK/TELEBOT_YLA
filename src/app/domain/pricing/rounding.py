# ๐งฉ app/domain/pricing/rounding.py
"""
๐งฉ rounding.py โ ะัะฐะฒะธะปะฐ ะพะบััะณะปะตะฝะฝั ัะฐ ะดะพะฟะพะผัะถะฝั ััะฝะบััั ะดะปั Decimal.

๐น ะะธะบะพัะธััะพะฒัััััั ั ััะฝะฐะฝัะพะฒะธั ัะพะทัะฐััะฝะบะฐั (ััะฝะธ, ะบะพะผัััั, ะดะพััะฐะฒะบะฐ).
๐น ะะฐัะฐะฝััั ะบะพัะตะบัะฝัััั ัะตะทัะปััะฐััะฒ ะทะฐะฒะดัะบะธ ะฟัะฐะฒะธะปั ROUND_HALF_UP.
"""

from __future__ import annotations

# ๐ ะกะธััะตะผะฝั ัะผะฟะพััะธ
from decimal import Decimal, getcontext, ROUND_HALF_UP  # ๐งฎ ะะพะฑะพัะฐ ะท ัะพัะฝะธะผะธ ัะธัะปะฐะผะธ (ะณัะพัั)

# ================================
# โ๏ธ ะะะะะจะขะฃะะะะะฏ ะขะะงะะะกะขะ
# ================================
getcontext().prec = 28												# ๐ง ะััะฐะฝะพะฒะปััะผะพ ะดะพััะฐัะฝั ัะพัะฝัััั ะดะปั ััะฝะฐะฝัะพะฒะธั ะพะฑัะธัะปะตะฝั

# --- ๐ ะะฒะฐะฝั ะดะปั ะณัะพัะพะฒะธั ะทะฝะฐัะตะฝั (ะบะพะฟัะนะบะธ/ัะตะฝัะฐ) ---
_MONEY_Q = Decimal("0.01")											# ๐ฒ ะะบััะณะปะตะฝะฝั ะทะฐะฒะถะดะธ ะดะพ 2 ะทะฝะฐะบัะฒ ะฟััะปั ะบะพะผะธ


# ================================
# ๐ข ะะะะะะะะะ ะคะฃะะะฆะะ
# ================================
def q2(value: Decimal) -> Decimal:
    """
    ๐ข ะะบััะณะปัั ัะธัะปะพ ะดะพ 2 ะทะฝะฐะบัะฒ ะฟััะปั ะบะพะผะธ.

    Args:
        value (Decimal): ๐งฎ ะััะดะฝะต ะทะฝะฐัะตะฝะฝั.

    Returns:
        Decimal: ๐ฒ ะะฝะฐัะตะฝะฝั, ะพะบััะณะปะตะฝะต ะทะฐ ะฟัะฐะฒะธะปะพะผ ROUND_HALF_UP.
    """
    return value.quantize(_MONEY_Q, rounding=ROUND_HALF_UP)			# โฌ๏ธโฌ๏ธ ะะปะฐัะธัะฝะต ะพะบััะณะปะตะฝะฝั (0.5 โ 1)


def percent(value: Decimal) -> Decimal:
    """
    ๐ ะะตัะตัะฒะพััั ะฒัะดัะพัะบะธ ั ะดะตัััะบะพะฒั ะดัะพะฑั.

    ะัะธะบะปะฐะด:
        15 โ 0.15 (ะทัััะฝะพ ะดะปั ะผะฝะพะถะตะฝะฝั: amount * percent(x)).

    Args:
        value (Decimal): ๐ ะะฝะฐัะตะฝะฝั ั ะฒัะดัะพัะบะฐั.

    Returns:
        Decimal: ๐ ะะฝะฐัะตะฝะฝั ั ะฒะธะณะปัะดั ะดัะพะฑั.
    """
    return value / Decimal("100")									# ๐ ะะตัะตะฒะพะดะธะผะพ ะฒัะดัะพัะบะธ ั ะบะพะตัััััะฝั
