# ‚ú® app/bot/services/custom_context.py
"""
‚ú® custom_context.py ‚Äî –ö–∞—Å—Ç–æ–º–Ω–∏–π —Ç–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è Telegram-–±–æ—Ç–∞.

üîπ –†–æ–∑—à–∏—Ä—é—î `CallbackContext`, –¥–æ–¥–∞—é—á–∏ –≤–ª–∞—Å–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏ –∑ —Ç–∏–ø–æ–≤–æ—é –∞–Ω–æ—Ç–∞—Ü—ñ—î—é.
üîπ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ callback-–∫–Ω–æ–ø–æ–∫.
"""

# üåê –ó–æ–≤–Ω—ñ—à–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
from telegram.ext import CallbackContext									# ü§ñ –ë–∞–∑–æ–≤–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑ python-telegram-bot

# üî† –°–∏—Å—Ç–µ–º–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏
from typing import Dict, Optional, cast								# üî§ –¢–∏–ø–∏ —Ç–∞ –±–µ–∑–ø–µ—á–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è

# üß© –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –º–æ–¥—É–ª—ñ –ø—Ä–æ—î–∫—Ç—É
from app.config.setup.constants import CONST							# ‚öôÔ∏è –°—Ç–∞—Ç–∏—á–Ω—ñ –∫–ª—é—á—ñ –¥–ª—è user_data


# ================================
# üèõÔ∏è –ö–ê–°–¢–û–ú–ù–ò–ô –ö–õ–ê–° –ö–û–ù–¢–ï–ö–°–¢–£
# ================================
class CustomContext(CallbackContext):
    """
    üß∞ –ö–∞—Å—Ç–æ–º–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫–∏–π —Ä–æ–∑—à–∏—Ä—é—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏
    –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö, —Ç–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤.

    –ú–∞—î –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ `context_types` –≤ `ApplicationBuilder`.
    """

    def __init__(self, *args, **kwargs) -> None:
        """‚öôÔ∏è –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –∫–ª–∞—Å —Ç–∞ –¥–æ–¥–∞—î –Ω–æ–≤—ñ –∞—Ç—Ä–∏–±—É—Ç–∏."""
        super().__init__(*args, **kwargs)									# üß¨ –ü–µ—Ä–µ–¥–∞—î–º–æ –±–∞–∑–æ–≤—É —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –≤ CallbackContext
        self.callback_params: Dict[str, str] = {}							# üß∑ –ú—ñ—Å—Ü–µ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ callback-–∫–Ω–æ–ø–æ–∫ (—Ç–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–æ)

    # ================================
    # ‚öôÔ∏è MODE
    # ================================
    @property
    def mode(self) -> Optional[str]:
        """üîé –¢–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏–π getter –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É —Ä–æ–±–æ—Ç–∏ –±–æ—Ç–∞."""
        return cast(dict, self.user_data).get(CONST.LOGIC.USER_DATA.MODE)		# üóÇÔ∏è –î—ñ—Å—Ç–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–º –∫–ª—é—á–µ–º

    @mode.setter
    def mode(self, value: Optional[str]) -> None:
        """‚úçÔ∏è –¢–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏–π setter –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É —Ä–æ–±–æ—Ç–∏ –±–æ—Ç–∞."""
        cast(dict, self.user_data)[CONST.LOGIC.USER_DATA.MODE] = value			# üß© –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É user_data

    # ================================
    # üåê URL
    # ================================
    @property
    def url(self) -> Optional[str]:
        """üîé –¢–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏–π getter –¥–ª—è URL, —â–æ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è."""
        return cast(dict, self.user_data).get(CONST.LOGIC.USER_DATA.URL)			# üåç –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π URL —ñ–∑ user_data

    @url.setter
    def url(self, value: Optional[str]) -> None:
        """‚úçÔ∏è –¢–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–∏–π setter –¥–ª—è URL, —â–æ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è."""
        cast(dict, self.user_data)[CONST.LOGIC.USER_DATA.URL] = value				# üß© –ó–±–µ—Ä—ñ–≥–∞—î–º–æ URL —É user_data
