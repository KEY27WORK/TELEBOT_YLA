
# Детальная инструкция для рефакторинга проекта с использованием ChatGPT

## Введение
Здравствуйте, ChatGPT! Пожалуйста, помогите мне с рефакторингом моего проекта. Основная цель — улучшение структуры и производительности, соблюдение лучших практик Python, сохранение текущего функционала и вычислительных выводов.

## Общий обзор
У меня есть несколько файлов, связанных с проверкой наличия товаров в различных регионах. Основные файлы, которые надо рассмотреть:

1. `availability_handler.py` - управляет проверкой наличия товаров.
2. `json_ld_parser.py` - парсинг данных из HTML.
3. `regional_availability_checker.py` - проверка и агрегация данных о наличии в регионах.
4. `availability_manager.py` - центральный агрегатор данных о наличии.
5. `base_parser.py` - базовый модуль для асинхронного парсинга.
6. `color_size_formatter.py` - форматирование данных для Telegram.

## Общие цели рефакторинга

1. **Улучшение Структуры и Модульности:**
   - Использование шаблона проектирования **Фасад** для объединения функционала в более упорядоченный интерфейс.
   - Разделить обязанности: каждый класс должен иметь одну ответственность (SRP из SOLID).
   - Пересмотрите возможность использования **Шаблон Стратегии** для различных видов парсинга.

2. **Оптимизация Производительности:**
   - Использовать `asyncio.gather()` для более эффективной параллельной обработки данных.
   - Подумайте о реализации кэширования результатов, чтобы минимизировать количество запросов к одной и той же информации.

3. **Устранение Заглушек:**
   - Закончить реализации в `regional_availability_checker.py` с использованием методик и логик из других модулей, таких как `json_ld_parser.py`.

4. **Обеспечение Поддерживаемости и Читаемости:**
   - Убедитесь, что вся документация и логирование доступны и ясны. Это поможет в будущем сопровождающим разработчикам.

5. **Реорганизация структуры проекта:**
   - Создать отдельную директорию, например, `product_availability`, и переместить все связанные файлы туда. Это поможет улучшить модульность и поддерживаемость.
   - Включить в `requirements.txt` все дополнительные библиотеки, используемые в новых реализациях.

## Подробные инструкции для каждого файла

### Для `availability_handler.py`:
- **Улучшение логики обработчика:** Пересмотрите структуру вызовов в функции `handle()`, переиспользуйте функционал менеджера для более согласованной реализации.
- **Шаблон Прокси:** Рассмотрите возможность добавления прокси-слоя для взаимодействия с менеджером, чтобы абстрагировать детали нижних слоев.

### Для `json_ld_parser.py`:
- **Объединение логик:** Вместо использования fallback сделайте модуль расширяемым, позволяющим добавлять больше стратегий парсинга без изменения основного кода.
- **Оптимизация и проверка исключений:** Внедрите более детализированный подход к ошибкообработке и логированию.

### Для `regional_availability_checker.py`:
- **Завершение методов:** Полностью реализовать базовые и полные методы проверки с использованием JsonLdAvailabilityParser вместо заглушек.
- **Интеграция с менеджером:** Обеспечьте совместимость с `AvailabilityManager` для унификации данных.

### Для `availability_manager.py`:
- **Централизация и оптимизация:** Убедитесь, что этот класс служит единственной точкой интеграции логики для обработчиков.
- **Кэширование данных:** Реализуйте кэширование, чтобы избежать повторных запросов.

### Для `base_parser.py`:
- **Упрощение и очистка кода:** Убедитесь, что базовый парсер используется только для общих операций, и метод парсинга разбит на более мелкие части.

### Для `color_size_formatter.py`:
- **Проверка форматирования:** Убедитесь, что вся логика формирования выводов соответствует современным стандартам. Используйте новые возможности Python, такие как формировочные строки.

## Заключение
Пожалуйста, выполните предложенные шаги по улучшению кода, сохраняя при этом функциональность. Предоставьте рекомендации по оптимизации кода.

Спасибо за вашу помощь!
