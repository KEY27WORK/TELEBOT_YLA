# âš™ï¸ app/config/yamls/local/99_local.yaml
# ================================
# ğŸ§© Ğ›ĞĞšĞĞ›Ğ¬ĞĞ† ĞĞ’Ğ•Ğ Ğ ĞĞ™Ğ”Ğ˜ (ĞĞ• ĞšĞĞœĞ†Ğ¢Ğ˜Ğ¢Ğ˜)
# ================================
# Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ”Ñ‚ÑŒÑÑ Ğ´Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ñ— Ñ€Ğ¾Ğ·Ñ€Ğ¾Ğ±ĞºĞ¸. Ğ”Ğ¾Ğ´Ğ°Ğ¹ Ñƒ .gitignore:
#   app/config/99_local.yaml
#
# Ğ¦ĞµĞ¹ Ñ„Ğ°Ğ¹Ğ» ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ˜Ğ¡Ğ£Ğ„ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ Ğ· app/config/yamls/**.
# Ğ¢Ñ€Ğ¸Ğ¼Ğ°Ğ¹ Ñ‚ÑƒÑ‚ ÑĞµĞºÑ€ĞµÑ‚Ğ¸, Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ– Ñ‚Ğ°Ğ¹Ğ¼Ñ–Ğ½Ğ³Ğ¸ Ñ‚Ğ° Ğ¾Ğ²ĞµÑ€Ñ€Ğ°Ğ¹Ğ´Ğ¸ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ñ–Ğ² Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ°.

# ğŸ”‘ Ğ¡ĞµĞºÑ€ĞµÑ‚Ğ¸ Ğ· .env
telegram:
  token: ${TELEGRAM_TOKEN}                  # ğŸ¤– Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ±Ğ¾Ñ‚-Ñ‚Ğ¾ĞºĞµĞ½

openai:
  api_key: ${OPENAI_API_KEY}               # ğŸ” Ğ¡ĞµĞºÑ€ĞµÑ‚ Ñ–Ğ· .env
  model: "gpt-4-turbo"                     # ğŸ§  ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ·Ğ° Ğ·Ğ°Ğ¼Ğ¾Ğ²Ñ‡ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼
  max_tokens: 1024                         # ğŸ”¢ Ğ›Ñ–Ğ¼Ñ–Ñ‚Ğ¸ Ğ´Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ñ… Ñ‚ĞµÑÑ‚Ñ–Ğ²
  # â¬‡ï¸ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ ĞºĞµÑˆ Ğ·Ğ°Ğ¿Ğ¸Ñ‚Ñ–Ğ² Ğ´Ğ¾ AI
  cache:
    enabled: true                          # ğŸ”› Ğ£Ğ²Ñ–Ğ¼ĞºĞ½ÑƒÑ‚Ğ¸ ĞºĞµÑˆ
    ttl_hours: 720                         # ğŸ“† 30 Ğ´Ñ–Ğ±
    max_items: 1000                        # ğŸ“¦ In-memory LRU
    persist_dir: ".cache/ai_translations"  # ğŸ’¾ Ğ¤Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ¸Ğ¹ Ğ±ĞµĞºĞµĞ½Ğ´

# ğŸŒ Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ– Ğ¾Ğ²ĞµÑ€Ñ€Ğ°Ğ¹Ğ´Ğ¸ Ñ€ĞµĞ³Ñ–Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¸Ñ… Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½ÑŒ
regions:
  labels:
    USD: "Ğ¡Ğ¨Ğ ğŸ‡ºğŸ‡¸"                        # ğŸ·ï¸ ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ– Ğ»ĞµĞ¹Ğ±Ğ»Ğ¸
    EUR: "Ğ„Ğ¡ ğŸ‡ªğŸ‡º"
    GBP: "Ğ‘Ñ€Ğ¸Ñ‚Ğ°Ğ½Ñ–Ñ ğŸ‡¬ğŸ‡§"

# ğŸ” Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ– Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Playwright / WebDriver
playwright:
  headless: false                          # ğŸ”“ ĞŸĞ¾ĞºĞ°Ğ·ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€
  navigation_timeout_ms: 45000             # â±ï¸ Ğ‘Ñ–Ğ»ÑŒÑˆĞ¸Ğ¹ Ñ‚Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ½Ğ°Ğ²Ñ–Ğ³Ğ°Ñ†Ñ–Ñ—
  retry_attempts: 2                        # ğŸ”„ ĞœĞµĞ½ÑˆĞµ Ñ€ĞµÑ‚Ñ€Ğ°Ñ—Ğ², Ñ‰Ğ¾Ğ± ÑˆĞ²Ğ¸Ğ´ÑˆĞµ Ñ„ĞµĞ¹Ğ»Ğ¸Ğ»Ğ¾ÑÑŒ

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§° Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ– Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ° (IMP-005)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
parser:
  selectors:
    # ĞŸĞ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ğ¹ Ğ±Ñ€ĞµĞ½Ğ´ (Ğ½ĞµĞ¾Ğ±Ğ¾Ğ²'ÑĞ·ĞºĞ¾Ğ²Ğ¾). Ğ¯ĞºÑ‰Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ â€” Ğ·Ğ°ÑÑ‚Ğ¾ÑÑƒÑÑ‚ÑŒÑÑ overrides Ğ· .brands.<brand>.
    brand: "youngla"                         # ğŸ§¾ ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ±Ñ€ĞµĞ½Ğ´Ğ°

    # === Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ– Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ¸ (Ğ¿ĞµÑ€ĞµĞºÑ€Ğ¸Ğ²Ğ°ÑÑ‚ÑŒ Ñ…Ğ°Ñ€Ğ´ĞºĞ¾Ğ´) ===
    defaults:
      TITLE_LIST:
        - "h1.product-title"
        - "h1.product__title"
        - "h1[itemprop='name']"
        - "meta[property='og:title']"
        - "title"

      PRICE_LIST:
        - ".price__current, .price--large, .product__price .price"
        - ".product-price, .sale-price, .price-item--regular, .price-item--sale"
        - "meta[itemprop='price']"

      MAIN_IMAGE_LIST:
        - 'meta[property="og:image"]'
        - ".product__media img[src], .product-gallery__image img[src]"
        - "img#FeaturedMedia-product-template[src]"

      ALL_IMAGES_LIST:
        - ".product-gallery__image-list img[src]"
        - ".product-gallery__thumbnail img[src]"
        - ".product-gallery__thumbnail-list img[src]"

      DESCRIPTION_CONTAINER_LIST:
        - '.product-info__block-item[data-block-type="description"] .prose'
        - 'div[data-block-type="description"] .prose'
        - "div.product__description, div#ProductAccordion-product-description .prose"
        - "div#product-description, section.product-description, .rte.product-description, .prose"

      JSON_LD_SCRIPT: 'script[type="application/ld+json"]'

      LEGACY_STOCK_SELECTORS:
        - "script#ProductJson"               # ğŸ§¾ Shopify JSON
        - 'script[data-product-json="true"]'
        - "script"

    # === ĞĞ²ĞµÑ€Ñ€Ğ°Ğ¹Ğ´Ğ¸ Ğ´Ğ»Ñ Ğ±Ñ€ĞµĞ½Ğ´Ñ–Ğ² (Ğ¾Ğ¿Ñ†Ñ–Ğ¹Ğ½Ğ¾) ===
    brands:
      youngla:
        DESCRIPTION_CONTAINER_LIST:
          - '.product-info__block-item[data-block-type="description"] .prose'
          - "div.product__description, #tab-description, .ProductMeta__Description, .prose"
          - 'div[data-block-type="description"] .prose'
          - "div#product-description, section.product-description, .rte.product__description, .prose"

        PRICE_LIST:
          - ".price__current, .price--large, .product__price .price, .ProductMeta__Price, .price-item"
          - ".product-price, .sale-price, .price-item--regular, .price-item--sale"
          - "meta[itemprop='price']"

        # Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´ Ñ€Ğ¾Ğ·ÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ key_map Ğ¿Ñ–Ğ´ Ğ±Ñ€ĞµĞ½Ğ´:
        # key_map:
        #   "MATERIAL & CARE": "ĞœĞĞ¢Ğ•Ğ Ğ˜ĞĞ›"
        #   "CARE INSTRUCTIONS": "Ğ”ĞĞ“Ğ›Ğ¯Ğ”"

  # ğŸ–¼ï¸ Ğ¤Ñ–Ğ»ÑŒÑ‚Ñ€Ğ¸ Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½ÑŒ (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ Ğ°Ğ³Ñ€ĞµÑĞ¸Ğ²Ğ½Ñ–ÑˆÑ–)
  images:
    min_side_px: 160                        # ğŸ“ Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¶Ğ¾Ñ€ÑÑ‚ĞºÑ–ÑˆĞ¸Ğ¹ Ğ¿Ğ¾Ñ€Ñ–Ğ³
    bad_tokens: ["sprite","logo","icon","placeholder","thumb"]  # ğŸ§¹ Ğ”Ğ¾Ğ´Ğ°Ñ”Ğ¼Ğ¾ Ğ±Ñ–Ğ»ÑŒÑˆĞµ ÑÑ‚Ğ¾Ğ¿-ÑĞ»Ñ–Ğ²
    allowed_ext: [".jpg",".jpeg",".png",".webp",".avif"]        # âœ… Ğ Ğ¾Ğ·ÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ

  # âœï¸ ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ° Ğ¾Ğ¿Ğ¸ÑÑ–Ğ² (IMP-049)
  description:
    as_markdown: true                       # ğŸ“ ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ÑƒÑ”Ğ¼Ğ¾ Ğ² Markdown
    preserve_lists: true                    # âœ… Ğ—Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ñ‚Ğ¸ ÑĞ¿Ğ¸ÑĞºĞ¸
    drop_tables: true                       # âŒ ĞŸÑ€Ğ¸Ğ±Ğ¸Ñ€Ğ°Ñ‚Ğ¸ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ–
    collapse_newlines: true                 # ğŸ§¼ Ğ—Ğ³Ğ¾Ñ€Ñ‚Ğ°Ñ‚Ğ¸ Ğ·Ğ°Ğ¹Ğ²Ñ– Ğ¿ĞµÑ€ĞµĞ½Ğ¾ÑĞ¸
    max_len: 0                              # â™¾ï¸ Ğ‘ĞµĞ· Ğ¾Ğ±Ñ€Ñ–Ğ·Ğ°Ğ½Ğ½Ñ
    strip_images: true                      # ğŸ–¼ï¸ Ğ’Ğ¸Ğ´Ğ°Ğ»ÑÑ‚Ğ¸ <img>
    strip_links: false                      # ğŸ”— Ğ›Ğ¸ÑˆĞ°Ñ‚Ğ¸ Ğ¿Ğ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ
    allowed_inline_tags: ["strong","em","b","i"]  # âœï¸ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ– ÑÑ‚Ğ¸Ğ»Ñ–

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§ª Feature-flags Ğ´Ğ»Ñ ĞµĞºÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ¾Ñ€Ñ–Ğ²
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
flags:
  extractors:
    description:
      enabled: true        # Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ñ‚ÑƒĞ¼Ğ±Ğ»ĞµÑ€ Ñ„Ñ–Ñ‡Ñ–
      strategy: "v2"       # "v1" Ğ°Ğ±Ğ¾ "v2"
      rollout_percent: 0   # 0..99 â€” Ñ‡Ğ°ÑÑ‚ĞºĞ° Ñ‚Ñ€Ğ°Ñ„Ñ–ĞºÑƒ Ğ½Ğ° v2, ÑĞºÑ‰Ğ¾ strategy != "v2"

# ÑĞº ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ÑÑ:
# 1) Ğ£Ğ²Ñ–Ğ¼ĞºĞ½ÑƒÑ‚Ğ¸ Ğ½Ğ¾Ğ²Ñƒ Ğ³Ñ–Ğ»ĞºÑƒ Ğ’Ğ¡Ğ†Ğœ:
#    flags.extractors.description:
#      enabled: true
#      strategy: "v2"
#      rollout_percent: 0
#
# 2) A/B 20% Ğ½Ğ° v2 (Ñ€ĞµÑˆÑ‚Ğ° â€” v1):
#    flags.extractors.description:
#      enabled: true
#      strategy: "v1"
#      rollout_percent: 20

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”Š Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ñ€Ñ–Ğ²ĞµĞ½ÑŒ Ğ»Ğ¾Ğ³ÑƒĞ²Ğ°Ğ½Ğ½Ñ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
logging:
  level: "DEBUG"                           # ğŸ”Š DEBUG|INFO|WARNING|ERROR
  console: true                            # ğŸ–¥ï¸ true/false â€” Ğ²Ğ¸Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğ¸ Ğ² stdout
  console_level: "INFO"                    # ğŸ”‰ Ğ Ñ–Ğ²ĞµĞ½ÑŒ Ğ´Ğ»Ñ ĞºĞ¾Ğ½ÑĞ¾Ğ»Ñ– (DEBUG...ERROR)
  json: false                              # ğŸ“„ true = JSON Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚, false = plain
  file: "logs/dev.log"                     # ğŸ—‚ï¸ Ğ¨Ğ»ÑÑ… Ğ´Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ñƒ (Ğ±ÑƒĞ´ÑŒ-ÑĞºĞ¸Ğ¹)
  file_level: "DEBUG"                      # ğŸ§¾ Ğ Ñ–Ğ²ĞµĞ½ÑŒ Ğ´Ğ»Ñ Ñ„Ğ°Ğ¹Ğ»Ñƒ (DEBUG...ERROR)
  console_format: "[%(levelname).1s] %(message)s"   # ğŸ§± Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ĞºĞ¾Ğ½ÑĞ¾Ğ»Ñ– (%(levelname)s Ñ‚Ğ¾Ñ‰Ğ¾)
  file_format: "%(asctime)s [%(levelname)s] - (%(name)s).%(funcName)s(%(lineno)d) - %(message)s"  # ğŸ“œ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ„Ğ°Ğ¹Ğ»Ñƒ
  suppress:
    httpx: "WARNING"                       # ğŸ¤« ĞœĞµĞ½ÑˆĞµ ÑˆÑƒĞ¼Ñƒ Ğ²Ñ–Ğ´ httpx

ocr:
  request_timeout_s: 45.0                 # â³ ĞšĞ¾Ñ€Ğ¾Ñ‚ÑˆĞ¸Ğ¹ Ñ‚Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ´Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ñ… Ñ‚ĞµÑÑ‚Ñ–Ğ²
  max_retries: 1                          # ğŸ” ĞœĞµĞ½ÑˆĞµ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ñ–Ğ²
  backoff_s: 2.0                          # ğŸ•’ Ğ¤Ñ–ĞºÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ backoff

# ğŸ” Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ– Ñ‚Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚Ğ¸ Ğ¿Ğ¾ÑˆÑƒĞºÑƒ YoungLA (ÑƒĞ½Ğ¸ĞºĞ°Ñ”Ğ¼Ğ¾ Ğ½Ğ°Ğ´Ñ‚Ğ¾ Ñ€Ğ°Ğ½Ğ½Ñ–Ñ… Ñ‚Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚Ñ–Ğ²)
search:
  goto_timeout_ms: 60000                   # â³ 60 c, Ğ±Ğ¾ ÑĞ°Ğ¹Ñ‚ Ñ–Ğ½ĞºĞ¾Ğ»Ğ¸ Ğ¿Ğ¾Ğ²Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹
  idle_timeout_ms: 20000                   # ğŸ˜´ +5 c Ğ´Ğ¾ Ğ¾Ñ‡Ñ–ĞºÑƒĞ²Ğ°Ğ½Ğ½Ñ network idle
  retry_attempts: 3                        # ğŸ” Ğ‘Ñ–Ğ»ÑŒÑˆĞµ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ñ–Ğ²
  retry_backoff_ms: 800                    # ğŸ•’ Ğ—Ğ±Ñ–Ğ»ÑŒÑˆÑƒÑ”Ğ¼Ğ¾ Ğ¿Ğ°ÑƒĞ·Ñƒ Ğ¼Ñ–Ğ¶ ÑĞ¿Ñ€Ğ¾Ğ±Ğ°Ğ¼Ğ¸
